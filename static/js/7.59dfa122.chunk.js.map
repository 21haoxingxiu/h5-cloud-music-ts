{"version":3,"sources":["containers/Singers/style.ts","containers/Rank/store/actionCreators.ts","api/rank.ts","containers/Rank/style.ts","containers/Rank/index.tsx"],"names":["NavContainer","styled","div","ListContainer","List","style","ListItem","EnterLoading","getRankList","dispatch","axiosInstance","get","then","data","list","type","actionTypes","changeRankList","changeLoading","Container","props","play","ul","globalRank","li","tracks","length","SongList","connect","state","rankList","rank","loading","songsCount","player","playList","size","getRankListDataDispatch","React","memo","useEffect","renderRankList","global","map","item","index","key","coverImgId","onClick","detail","history","push","id","className","src","coverImgUrl","alt","updateFrequency","first","second","renderSongList","globalStartIndex","filterIndex","officialList","slice","globalList","displayStyle","Scroll","Loading","renderRoutes","route","routes"],"mappings":"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","file":"static/js/7.59dfa122.chunk.js","sourcesContent":["/*\n * @Description: new file\n * @Autor: zhan\n * @Date: 2020-06-09 15:07:53\n * @LastEditors: zhan\n * @LastEditTime: 2020-06-09 19:30:52\n */ \nimport styled from'styled-components';\nimport style from '../../assets/globalStyle'\n\nexport const NavContainer  = styled.div`\n  box-sizing: border-box;\n  position: fixed;\n  top: 95px;\n  width: 100%;\n  padding: 5px;\n  overflow: hidden;\n`;\n\nexport const ListContainer = styled.div`\n  position: fixed;\n  top: 160px;\n  left: 0;\n  bottom: 0;\n  overflow: hidden;\n  width: 100%;\n`;\n\nexport const List = styled.div`\n  display: flex;\n  margin: auto;\n  flex-direction: column;\n  overflow: hidden;\n  .title {\n    margin:10px 0 10px 10px;\n    color: ${style[\"font-color-desc\"]};\n    font-size: ${style[\"font-size-s\"]};\n  }\n`;\nexport const ListItem = styled.div`\n  box-sizing: border-box;\n  display: flex;\n  flex-direction: row;\n  margin: 0 5px;\n  padding: 5px 0;\n  align-items: center;\n  border-bottom: 1px solid ${style[\"border-color\"]};\n  .img_wrapper {\n    margin-right: 20px;\n    img {\n      border-radius: 3px;\n      width: 50px;\n      height: 50px;\n    }\n  }\n  .name {\n    font-size: ${style[\"font-size-m\"]};\n    color: ${style[\"font-color-desc\"]};\n    font-weight: 500;\n  }\n`;\n\nexport const EnterLoading = styled.div`\n  position: fixed;\n  left: 0; right: 0; top: 0; bottom: 0;\n  width: 100px;\n  height: 100px;\n  margin: auto;\n`","/*\n * @Description: new file\n * @Autor: zhan\n * @Date: 2020-06-09 21:40:33\n * @LastEditors: zhan\n * @LastEditTime: 2020-06-21 11:07:47\n */ \nimport * as actionTypes from './constants';\nimport {\n  getRankListRequest\n} from \"../../../api/rank\";\n\n\nconst changeRankList = (data:any) => ({\n  type: actionTypes.CHANGE_RANK_LIST,\n  data: data\n})\n\nconst changeLoading = (data:boolean) => ({\n  type: actionTypes.CHANGE_LOADING,\n  data\n})\n\nexport const getRankList = () => {\n  return (dispatch:any) => {\n    getRankListRequest().then((data:any) => {\n      let list = data && data.list;\n      dispatch(changeRankList(list));\n      dispatch(changeLoading(false));\n    })\n  }\n}\n","/*\r\n * @Description: new file\r\n * @Autor: zhan\r\n * @Date: 2020-07-20 10:01:47\r\n * @LastEditors: zhan\r\n * @LastEditTime: 2020-07-20 10:01:47\r\n */ \r\n\r\nimport { axiosInstance } from \"../utils/request\";\r\n\r\n\r\nexport const getRankListRequest  = () => {\r\n  return axiosInstance.get(`/toplist/detail`);\r\n};","/*\n * @Description: new file\n * @Autor: zhan\n * @Date: 2020-07-20 09:55:39\n * @LastEditors: zhan\n * @LastEditTime: 2020-07-20 12:14:38\n */ \nimport styled from 'styled-components';\nimport style from '../../assets/globalStyle';\n\n// Props中的globalRank和tracks.length均代表是否为全球榜\ninterface IListProp {\n  globalRank: any\n}\ninterface IListItemProp {\n  tracks: []\n}\ninterface IContainerProp {\n  play: any\n}\n\nexport const Container = styled.div`\n  position: fixed;\n  top: 90px;\n  bottom: ${(props:IContainerProp) => props.play > 0?\"60px\": 0};\n  width: 100%;\n  .offical,.global {\n    margin: 10px 5px;\n    padding-top: 15px;\n    font-weight: 700;\n    font-size: ${style[\"font-size-m\"]};\n    color: ${style[\"font-color-desc\"]};\n  }\n`\n\nexport const List = styled.ul`\n  margin-top: 10px;\n  padding: 0 5px;\n  display: ${(props:IListProp) => props.globalRank ? \"flex\": \"\" };\n  flex-direction: row;\n  justify-content: space-between;\n  flex-wrap: wrap;\n  background: ${style[\"background-color\"]};\n  &::after{\n    content:\"\";\n    display:block;\n    width: 32vw;\n  }\n`\nexport const ListItem = styled.li`\n  display: ${(props:IListItemProp) => props.tracks.length ? \"flex\": \"\"};\n  padding: 3px 0;\n  border-bottom: 1px solid ${style[\"border-color\"]};\n  .img_wrapper{\n    width:  ${(props:IListItemProp) => props.tracks.length ? \"27vw\": \"32vw\"};\n    height: ${(props:IListItemProp) => props.tracks.length ? \"27vw\": \"32vw\"};\n    border-radius: 3px;\n    position: relative;\n    .decorate {\n      position: absolute;\n      bottom: 0;\n      width: 100%;\n      height: 35px;\n      border-radius: 3px;\n      background: linear-gradient(hsla(0,0%,100%,0),hsla(0,0%,43%,.4));\n    }\n    img{\n      width: 100%;\n      height: 100%;\n      border-radius: 3px;\n    }\n    .update_frequecy{\n      position: absolute;\n      left: 7px;\n      bottom: 7px;\n      font-size: ${style[\"font-size-ss\"]};\n      color: ${style[\"font-color-light\"]};\n    }\n  }\n`\nexport const SongList = styled.ul`\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  justify-content: space-around;\n  padding: 10px 10px;\n  >li{\n    font-size: ${style[\"font-size-s\"]};\n    color: grey;\n  }\n`","import React, { useEffect } from 'react';\nimport { connect } from 'react-redux';\nimport { getRankList } from './store/actionCreators'\nimport Loading from '../../components/Loading';\nimport {\n  List, \n  ListItem,\n  SongList,\n  Container\n} from './style';\nimport Scroll from '../../components/Scroll';\nimport { EnterLoading } from './../Singers/style';\nimport { filterIndex } from 'utils';\nimport { renderRoutes } from 'react-router-config';\n\nfunction Rank(props:any) {\n  const { rankList:list, loading, songsCount } = props;\n  const { getRankListDataDispatch } = props;\n\n  let rankList = list ? list : [];\n\n  useEffect(() => {\n    if(!rankList.length){\n      getRankListDataDispatch();\n    }\n    // eslint-disable-next-line\n  }, []);\n\n  const enterDetail = (detail:any) => {\n    props.history.push(`/rank/${detail.id}`)\n  }\n  const renderSongList = (list:any) => {\n    return list.length ? (\n      <SongList>\n        {\n          list.map((item:any, index:number) => {\n            return <li key={index}>{index+1}. {item.first} - {item.second}</li>\n          })\n        }\n      </SongList>\n    ) : null;\n  }\n  const renderRankList = (list:any, global?:any) => {\n    return (\n      <List globalRank={global}>\n       {\n        list.map((item:any, index:number) => {\n          return (\n            <ListItem key={`${item.coverImgId}${index}`} tracks={item.tracks} onClick={() => enterDetail(item)}>\n              <div className=\"img_wrapper\">\n                <img src={item.coverImgUrl} alt=\"\"/>\n                <div className=\"decorate\"></div>\n                <span className=\"update_frequecy\">{item.updateFrequency}</span>\n              </div>\n              { renderSongList(item.tracks)  }\n            </ListItem>\n          )\n       })\n      } \n      </List>\n    )\n  }\n\n  let globalStartIndex = filterIndex(rankList);\n  let officialList = rankList.slice(0, globalStartIndex);\n  let globalList = rankList.slice(globalStartIndex);\n  let displayStyle = loading ? {\"display\":\"none\"}:  {\"display\": \"\"};\n  return (\n    <Container play={songsCount}>\n      <Scroll>\n        <div>\n          <h1 className=\"offical\" style={displayStyle}>官方榜</h1>\n            { renderRankList(officialList) }\n          <h1 className=\"global\" style={displayStyle}>全球榜</h1>\n            { renderRankList(globalList, true) }\n          { loading ? <EnterLoading><Loading></Loading></EnterLoading> : null }\n        </div>\n      </Scroll> \n      {renderRoutes(props.route.routes)}\n    </Container>\n    );\n}\n\n// 映射Redux全局的state到组件的props上\nconst mapStateToProps = (state:any) => ({\n  rankList: state.rank.rankList,\n  loading: state.rank.loading,\n  songsCount: state.player.playList.size\n});\n// 映射dispatch到props上\nconst mapDispatchToProps = (dispatch:any) => {\n  return {\n    getRankListDataDispatch() {\n      dispatch(getRankList());\n    }\n  }\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(React.memo(Rank));"],"sourceRoot":""}